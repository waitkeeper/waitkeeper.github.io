# 什么是流动性资金池，它入如何运作的？


## 流动性资金池
流动性池（LIQUIDITY POOL）指的是一池被锁在智能合约内的代币。它们借由提供流动性来促进交易。这些流动性池会被去中心化交易平台（DEX）所运用。最早采用流动性池的是 Bancor，但真正让它流行起来的是 Uniswap。

在我们解释流动性池是如何在其中运作，以及 AMM（自动化做市商）是什么之前，先让我们了解为什么需要它？

## 为什么 DeFi 需要流动性池？

如果你熟知像是 Coinbase 或是 Binance 这样的交易平台，你会知道，那里的交易是基于订单簿模型（order book model）。这跟传统股票市场一样，像是纽交所（NYSE）还有纳斯达克（Nasdaq）。

在这些订单簿模型市场中，买家和卖家会各自制定他们的订单。买家（又称 BIDDERS，投标人）期望用最低价买到想要的资产，而卖家则是期望用最高价卖出同一项资产。

因此，交易要成立，买卖双方必须要在价格上达到共识。交易可能在两种情况发生，一是买家提高投标价，二是卖家降价出售。

但若是没有人愿意重新出价怎么办？又或者你想买的币数量不够怎么办？

这时候，必须依靠做市商（market maker）的参与了。简单来说，做市商是一个促进交易的实体，它会一直接受买单与卖单，借此提供流动性（Liquidity）。因此，用户可以不需要等待对手方出现才能交易。

### 为什么去中心化金融(DeFi)不能仿造这种机制呢？

其实是可以的。只是它会变得又慢、又贵，而且还很难用。主要原因是，订单簿模型相当依赖做市商，要有很多个做市商，针对某项资产一直不断地做市。若是没有做市商，交易所会立刻变得不具流动性。对于一般用户来说，就会变得很难用。

除此之外，做市商需要一直追踪现时价格，并持续改变他们的出价，然后会有庞大数量的订单发向交易所。

以太坊每秒可以处理 12~15 笔交易，出块时间在 10~19 秒间，这对于订单簿交易所来说，并不是一个可行的选项。每笔与智能合约互动的交易，都会需要 Gas Fee（可视为手续费）。做市商光是提出订单，就可能让他们破产。

### 那第二层协议可以解决这个问题吗？

有些第二层协议，像是 Loopring（路印协议）看起来蛮可靠的，但就算是他们，仍然依赖着做市商，而同样会面临流动性问题。不仅如此，如果有用户想要做一笔交易，在第二层协议出入金，还必须多经过两道手续。

这也是为什么要发明新东西，让它在去中心化的世界更加流畅运作的理由。而这就是为什么需要流动性池的原因了。

## 流动性池是怎么运作的呢？

一般来说，一个流动性池会有两种代币，这两种代币形成一个新的交易对市场。DAI / ETH 可以作为一个很好的流动性池范例，它在 Uniswap 上相当受欢迎。

当一个新的流动性池被创建时，第一个流动性提供者（Liquidity Provider，LP）会设定在池中的初始价格，LP 会被驱使着让池中的两种资产维持等价值。如果池中的初始价格，与全球市场价格脱节，那就会立即产生一个套利空间，让 LP 损失资金。对于后续加入资金池的 LP 来说，同样会面临这样的风险。

当流动性池获得流动性时（可理解为注入资金），LP 会获得一个特殊的 LP 代币，代表着他们提供了多少比例的流动性。

当交易是由此流动性池所促进时，0.3 % 的交易费用会按照比例分给所有 LP 代币的持有者。如果 LP 想要抽回他们提供的流动性资金，其所代表的 LP 代币就必须被销毁。

每次有 LP 代币被销毁，就会根据确定性算法（Deterministic algorithm）启动价格调整，这样的机制，也就是自动化做市商（Automated Market Maker, AMM）。

而在每一种不同的协议中，他们所用的 AMM 算法都有些不一样。基础流动性池（basic liquidity pool），像是 Uniswap，使用的是**恒定乘积做市商算法（constant product market maker algorithm）：ｘ\* y = k**，让 x 代币数量与 y 代币数量的乘积，永远等于常数 k。

正因为这样的演算法，流动性池可以永远提供流动性，无论交易多大。主要是因为，当某代币的需求增加时，这个算法会一直增加它的价格。

**这种流动性池的重点在于，代币的比例支配着价格。**

举例而言，在 DAI / ETH 的池子中投入 DAI 买入 ETH，就会造成 ETH 的价格上升，而 DAI 的价格会下降。

**价格移动的幅度，则是依据交易的大小、池子的大小而定。越大的池子，就能承受越大的交易量，对价格的冲击也比较小（也就是所谓的滑价 Slippage）。**总之，越大的池子可以乘载越大的交易，而且产生的滑价比较小。

因为大池子滑价比较小，可以带来更好的交易体验。有些协议，像是 Balancer，开始给予 LP 更多的奖励，以吸引流动性，这样的过程，就叫做「流动性挖矿」（liquidity mining）。流动性池、自动化做市商的概念很简单，但也很有用。如果我们不用中心化的订单簿，那我们就不需要做市商的外部支持。

上述的流动性池机制，被用于 Uniswap，他们是最基础的流动性池。其他流动性池复制了这样的概念，并且加入了一些有趣的想法。

像是 Curve，他们发现 Uniswap 的 AMM 机制，在两种价格相近的资产间，运作的并不顺利。像是稳定币，或是同一种代币的衍生产品（像是 WETH / SETH）。Curve 池子的演算法，在交易这一类型代币时，可以提供更低的手续费，还有滑价也会更低。

还有另外一种流动性池的例子 – Balancer，他们发现我们不需要把池子里的资产限制为两种。 Balancer 容许一个池子内可以至多放入八种资产。

## 有哪些潜在风险？

典型的 DeFi 风险就是智能合约的漏洞、管理者密钥，还有系统性风险。还有就是暂时性损失（impermanent loss）跟流动性池骇客。这些内容都会在之后的影片中继续说明，链新闻也会同步追踪。
